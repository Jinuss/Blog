<!DOCTYPE html>
<html>
<title>MutationObserver</title>

<head>
    <title>MutationObserver</title>
</head>
<style>
    html,
    body {
        margin: 0 auto;
        padding: 0;
        height: 100%;
    }

    .Panel {
        height: 100%;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .container {
        margin: 50px;
        height: calc(100% - 100px);
        width: calc(100% - 100px);
        border: 1px solid red;
        display: flex;
        flex-wrap: wrap;
    }

    .container>div {
        width: calc(50% - 22px);
        height: calc(50% - 22px);
        padding: 10px;
    }

    .container>div:nth-child(1) {
        border-right: 1px solid red;
        border-bottom: 1px solid red;
    }

    .container>div:nth-child(4) {
        border-left: 1px solid red;
        border-top: 1px solid red;
        margin-top: -2px;
    }

    #div1 {
        width: 200px;
        height: fit-content;
        margin: 0 auto;
        background-color: orange;
    }

    #imgList {
        display: flex;
        /* flex-direction: column; */
        flex-wrap: wrap;
        overflow: auto;
        height: calc(100% - 40px);
        justify-content: center;
    }

    #imgList img {
        width: 202px;
        height: 66px;
        /* width: calc(50% - 20px); */
        padding: 10px;
    }
</style>

<body>
    <div class="Panel">
        <div class="container">
            <div>
                <p>变动观察器 MutationObserver</p>
                <div id="div1" ondrag="drag(event)" draggable="true">Hello</div>
                <button onclick="add()">add</button>
            </div>
            <div>
                <p>调整观察器 ResizeObserver</p>
            </div>
            <div>
                <p>交叉观察器 IntersectionObserver</p>
                <div id="imgList">
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                    <img data-src="https://www.baidu.com/img/flexible/logo/pc/result.png" alt="" src="" />
                </div>
            </div>
            <div>
                <p>性能观察器 PerformanceObserver</p>
            </div>
        </div>
    </div>
    <script>
        var callback = function (mutations, observer) { console.log("🚀 ~ mutations, observer:", mutations, observer) };


        var config = { attributes: true, childList: true, characterData: true };

        // 创建一个观察者实例并传入回调函数
        var observer = new MutationObserver(callback);
        function drag(ev) {
            // console.log("🚀 ~ drag ~ ev:", ev)
            ev.dataTransfer.setData("text", ev.target.id);
        }

        observer.observe(document.getElementById("div1"), config);

        function add() {
            // 创建一个 <span> 元素
            var spanElement = document.createElement("p");

            // 可选：添加文本内容
            spanElement.textContent = "这是一个 p 元素";

            // 找到要添加 <span> 元素的父元素，假设父元素的 id 为 "container"
            var parentElement = document.getElementById("div1");

            // 将 <span> 元素添加到父元素中
            parentElement.appendChild(spanElement);
        }

        var resizeObserver = new ResizeObserver(function (entries) {
            console.log(entries);
        });
        resizeObserver.observe(document.getElementById("div1"));

        // 交叉观察器
        var intersectionObserver = new IntersectionObserver(function (entries, intersectionobserver) {
            entries.forEach(function (entry) {
                if (entry.isIntersecting) {
                    entry.target.src = entry.target.dataset.src;
                    // intersectionobserver.unobserve(entry.target);
                }
            });
        }, { threshold: 0.5 });
        var aImgs = document.getElementsByTagName("img")
        for (var i = 0; i < aImgs.length; i++) {
            intersectionObserver.observe(aImgs[i]);
        }

        //性能观察器
        if (window.PerformanceObserver) {
            var po = new PerformanceObserver(function (list) {
                var entries = list.getEntries();
                console.log(entries);
            });

            po.observe({ entryTypes: ['resource', 'paint'], buffered: true });
        }
    </script>
</body>

</html>