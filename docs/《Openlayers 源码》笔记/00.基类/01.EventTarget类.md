---
title: EventTarget类
date: 2024-12-02 18:00:51
permalink: /pages/fa9141/
categories:
  - 《Openlayers 源码》笔记
  - 基类
tags:
  -
author:
  name: 东流
  link: https://github.com/Jinuss
---

## 概述

`EventTarget`类是 Openlayers 中许多类实现的基类，主要和事件监听触发有关。

## 源码剖析

### `Disposable`类

`EventTarget`类继承于`Disposable`类，其实现如下：

```js
class Disposable {
  constructor() {
    this.disposed = false;
  }

  dispose() {
    if (!this.disposed) {
      this.disposed = true;
      this.disposeInternal();
    }
  }

  disposeInternal() {}
}
```

`Disposable`类中定义了一个`disposed`变量，默认值为`false`,两个方法`dispose()`和`disposeInternal()`。

`dispose`译为处置，由此推定`Disposable`类就是用于在函数调用后执行某些`clean up`操作。

### `Target`类

`EventTarget`类即`target`实现如下：

```js
class Target extends Disposable {
  constructor(target) {
    super();
    this.eventTarget_ = target;
    this.pendingRemovals_ = null;
    this.dispatching_ = null;
    this.listeners_ = null;
  }

  addEventListener(type, listener) {}
  dispatchEvent(event) {}
  disposeInternal() {}
  getListeners() {}
  hasListener() {}
  removeEventListener() {}
}
```

#### `EventTarget`变量
`EventTarget`类接收一个`event`类型的参数，
- `eventTarget_`:
- `pendingRemovals`
- `dispatching_`
- `listeners_`

#### `EventTarget`方法

- `addEventListener`
- `dispatchEvent`
- `getListeners`
- `hasListeners`
- `removeListener`
