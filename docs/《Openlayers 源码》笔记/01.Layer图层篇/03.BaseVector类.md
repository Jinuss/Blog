---
title: BaseVector类
date: 2024-12-04 14:54:15
permalink: /pages/7c8d02/
categories:
  - 《Openlayers 源码》笔记
  - Layer图层篇
tags:
  -
author:
  name: 东流
  link: https://github.com/Jinuss
---

## 概述

## 源码剖析

```js
class BaseVectorLayer extends Layer {
  constructor(options) {
    options = options ? options : {};

    const baseOptions = Object.assign({}, options);

    delete baseOptions.style;
    delete baseOptions.renderBuffer;
    delete baseOptions.updateWhileAnimating;
    delete baseOptions.updateWhileInteracting;
    super(baseOptions);

    this.declutter_ = options.declutter ? String(options.declutter) : undefined;
    this.renderBuffer_ =
      options.renderBuffer !== undefined ? options.renderBuffer : 100;
    this.style_ = null;
    this.styleFunction_ = undefined;

    this.setStyle(options.style);
    this.updateWhileAnimating_ =
      options.updateWhileAnimating !== undefined
        ? options.updateWhileAnimating
        : false;

    this.updateWhileInteracting_ =
      options.updateWhileInteracting !== undefined
        ? options.updateWhileInteracting
        : false;
  }
  getDecluttter() {
    return this.declutter_;
  }
  getFetaures(pixel) {
    return super.getFeatures(pixel);
  }
  getRenderBuffer() {
    return this.renderBuffer_;
  }
  getRenderOrder() {
    return this.get(Property.RENDER_ORDER);
  }
  getStyle() {
    return this.style_;
  }
  getStyleFunction() {
    return this.styleFunction_;
  }
  getUpdateWhileAnimating() {
    return this.updateWhileAnimating_;
  }
  getUpdateWhileInteracting() {
    return this.updateWhileInteracting_;
  }
  renderDeclutter(frameState, layerState) {
    const declutterGroup = this.getDeclutter();
    if (declutterGroup in frameState.declutter === false) {
      frameState.declutter[declutterGroup] = new RBush(9);
    }
    this.getRenderer().renderDeclutter(frameState, layerState);
  }
  setRenderOrder() {
    this.set(Property.RENDER_ORDER, renderOrder);
  }
  setStyle(style) {
    this.style_ = style === undefined ? createDefaultStyle : style;
    const styleLike = toStyleLike(style);
    this.styleFunction_ =
      style === null ? undefined : toStyleFunction(styleLike);
    this.changed();
  }
}
```

## 总结
