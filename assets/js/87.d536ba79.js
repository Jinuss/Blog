(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{454:function(s,a,t){"use strict";t.r(a);var n=t(4),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"问题背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题背景"}},[s._v("#")]),s._v(" 问题背景")]),s._v(" "),a("p",[s._v("前端是用"),a("code",[s._v("React")]),s._v("搭建，使用"),a("code",[s._v("craco")]),s._v("配置，相关库或插件版本如下")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@craco/craco"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^7.1.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"react-scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^5.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"craco-less"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^3.0.1"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("在生产环境，"),a("code",[s._v("Node.js")]),s._v("构建时，报错如下")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Error: Found an unhandled loader "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the developement webpack config: node_modules/style-loader/index.js\n\nThis error probably occurred because you updated react-scripts or craco. Please try updating craco-less to the latest version:\n\n   $ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" upgrade craco-less\n\nOr:\n\n   $ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" update craco-less\n\nIf that doesn"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t work, craco-less needs to be fixed to support the latest version.\nPlease check to see if there'")]),s._v("s already an issue "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the FormAPI/craco-less repo:\n\n   * https://github.com/FormAPI/craco-less/issues?q"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("is%3Aissue+webpack+unknown+rule\n\nIf not, please "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" an issue and we'll take a look. "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Or you can send a PR"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nYou might also want to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("look")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" related issues "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the craco and create-react-app repos:\n\n   * https://github.com/sharegate/craco/issues?q"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("is%3Aissue+webpack+unknown+rule\n   * https://github.com/facebook/create-react-app/issues?q"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("is%3Aissue+webpack+unknown+rule\n\n    at throwUnexpectedConfigError "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("./node_modules/@craco/craco/lib/plugin-utils.js:29:11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at throwError "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("./node_modules/craco-less/lib/craco-less.js:14:5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("./node_modules/craco-less/lib/craco-less.js:119:7\n    at Array.forEach "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("anonymous"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Object.overrideWebpackConfig "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("./node_modules/craco-less/lib/craco-less.js:51:11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at overrideWebpack "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("./node_modules/@craco/craco/lib/features/plugins.js:42:40"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("./node_modules/@craco/craco/lib/features/plugins.js:64:29\n    at Array.forEach "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("anonymous"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at applyWebpackConfigPlugins "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("./node_modules/@craco/craco/lib/features/plugins.js:63:29"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at mergeWebpackConfig "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("./node_modules/@craco/craco/lib/features/webpack/merge-webpack-config.js:67:30"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("h2",{attrs:{id:"解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[s._v("#")]),s._v(" 解决方案")]),s._v(" "),a("p",[s._v("尝试在"),a("code",[s._v("craco-less")]),s._v("的 github 和网上寻找方法，设置"),a("code",[s._v("NODE_NODE_ENV")]),s._v("依旧无效，项目中用到"),a("code",[s._v("less")]),s._v("无非是想使用"),a("code",[s._v("CSS Module")]),s._v("，实现 CSS 的局部使用。"),a("code",[s._v("craco-less")]),s._v("最近的一次更新还是 8 个月之前，且最新版本上仍然有很多 issues 未被解决，因此放弃"),a("code",[s._v("craco-less")]),s._v("，改用"),a("code",[s._v("craco-css-modules")])]),s._v(" "),a("p",[a("code",[s._v("craco-css-modules")]),s._v("的参考地址："),a("a",{attrs:{href:"https://github.com/crazyurus/craco-css-modules",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/crazyurus/craco-css-modules"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("实现"),a("code",[s._v("CSS Module")]),s._v("前后区别：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Before")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" styles "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./index.module.less"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// After")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" styles "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./index.css"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);