(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{344:function(t,s,a){"use strict";a.r(s);var e=a(4),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"pinia-源码浅析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pinia-源码浅析"}},[t._v("#")]),t._v(" Pinia 源码浅析")]),t._v(" "),s("h4",{attrs:{id:"vue-demi"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-demi"}},[t._v("#")]),t._v(" vue-demi")]),t._v(" "),s("p",[s("code",[t._v("Pinia")]),t._v(" 中只用到了 vue-demi 一种库，vue-demi 的介绍可以参考 "),s("a",{attrs:{href:"https://github.com/vuejs/vue-demi",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-demi"),s("OutboundLink")],1)]),t._v(" "),s("h4",{attrs:{id:"createpinia"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#createpinia"}},[t._v("#")]),t._v(" "),s("code",[t._v("createPinia")])]),t._v(" "),s("p",[s("code",[t._v("createPinia")]),t._v("函数是"),s("code",[t._v("Pinia")]),t._v("的核心函数，它返回一个"),s("code",[t._v("Pinia")]),t._v("实例，该实例包含"),s("code",[t._v("install")]),t._v("方法，用于安装"),s("code",[t._v("Pinia")]),t._v("插件,以及"),s("code",[t._v("use")]),t._v("方法，用于注册插件，比如数据持久化插件"),s("code",[t._v("piniaPluginPersistedstate")])]),t._v(" "),s("p",[s("code",[t._v("vueDemi.markRaw")]),t._v(" 将对象标记为不可被代理，防止被代理对象被修改")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPinia")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pinia "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("vueDemi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("markRaw")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("install")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*...*/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*...*/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         _p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_a")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_e")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("scope"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_s")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" pinia\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("h3",{attrs:{id:"definestore-定义-store"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#definestore-定义-store"}},[t._v("#")]),t._v(" "),s("code",[t._v("defineStore")]),t._v(" 定义 Store")]),t._v(" "),s("p",[s("code",[t._v("vueDemi.hasInjectionContext()")]),t._v(" 函数用于检查当前环境是否具有注入上下文，返回的是一个布尔值")]),t._v(" "),s("p",[s("code",[t._v("defineStore")]),t._v(" 定义 store，接受一个唯一的 id 字符串和 store 配置项，其中定义并返回了"),s("code",[t._v("useStore")]),t._v("函数,配置项可以是函数也可以是对象, "),s("code",[t._v("defineStore")]),t._v("内部提供了"),s("code",[t._v("createSetupStore")]),t._v("和"),s("code",[t._v("createOptionsStore")]),t._v("两种方式创建 store")]),t._v(" "),s("h4",{attrs:{id:"createsetupstore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#createsetupstore"}},[t._v("#")]),t._v(" "),s("code",[t._v("createSetupStore")])]),t._v(" "),s("p",[s("code",[t._v("createSetupStore")]),t._v(" 接收6个参数,分别是"),s("code",[t._v("id")]),t._v(","),s("code",[t._v("setup")]),t._v(","),s("code",[t._v("options")]),t._v(","),s("code",[t._v("pinia")]),t._v(","),s("code",[t._v("hot")]),t._v(","),s("code",[t._v("isOptionsStore")])]),t._v(" "),s("h4",{attrs:{id:"createoptionsstore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#createoptionsstore"}},[t._v("#")]),t._v(" "),s("code",[t._v("createOptionsStore")])])])}),[],!1,null,null,null);s.default=n.exports}}]);